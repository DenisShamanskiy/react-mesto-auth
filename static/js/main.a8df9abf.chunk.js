(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{19:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(20),o=n.n(i),s=n(8),r=(n(19),n(22)),l=n(2),u=n(3),b=n.p+"static/media/header__logo.1f1e9591.svg",j=n(0);var d=function(e){var t=e.isLoggedIn,n=e.userEmail,c=e.onSignOut,i=e.isLoading,o=Object(u.h)(),r="/sign-in"===o.pathname,d="/"===o.pathname,_=Object(a.useState)(!1),m=Object(l.a)(_,2),h=m[0],p=m[1];function O(){p(!h)}return Object(j.jsxs)("header",{className:"header ".concat(h?"":"page__container"," ").concat(h?"header_columned":""),children:[Object(j.jsxs)("div",{className:"header__logo-container ".concat(h?"header__logo-container_type_column":""),children:[Object(j.jsx)("img",{className:"header__logo",src:b,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}),Object(j.jsx)("button",{onClick:O,type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u0435\u043d\u044e",className:"button-close button-close_place_header ".concat(h?"button-close_active":"")})]}),Object(j.jsxs)("div",{onClick:O,className:"header__button-menu ".concat(!t||h?"header__button-menu_type_inactive":""),children:[Object(j.jsx)("div",{className:"header__burger-line"}),Object(j.jsx)("div",{className:"header__burger-line"}),Object(j.jsx)("div",{className:"header__burger-line"})]}),!i&&Object(j.jsxs)("nav",{className:"header__nav-container ".concat(t&&!h?"header__nav-container_type_inactive":""," ").concat(h?"header__nav-container_type_column":""," "),children:[Object(j.jsx)("p",{className:"header__email-user",children:t?n:""}),r?Object(j.jsx)(s.c,{className:"header__nav-item",activeClassName:"header_nav-item_active",to:"/sign-up",children:t?"":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}):Object(j.jsx)(s.c,{onClick:t?function(){c(),p(!1)}:function(){},className:"header__nav-item ".concat(d?"header__nav-item_active":""),to:"/sign-in",children:t?"\u0412\u044b\u0439\u0442\u0438":"\u0412\u043e\u0439\u0442\u0438"})]})]})};var _=function(e){var t=e.title,n=e.name,c=e.buttonSubmitText,i=e.onSubmit,o="/sign-up"===Object(u.h)().pathname,r=Object(a.useState)(""),b=Object(l.a)(r,2),d=b[0],_=b[1],m=Object(a.useState)(""),h=Object(l.a)(m,2),p=h[0],O=h[1],f=Object(a.useState)(""),v=Object(l.a)(f,2),g=v[0],x=v[1],S=Object(a.useState)(""),N=Object(l.a)(S,2),k=N[0],C=N[1],y=Object(a.useState)(!1),L=Object(l.a)(y,2),T=L[0],D=L[1],E=Object(a.useState)(!0),A=Object(l.a)(E,2),w=A[0],I=A[1],P=Object(a.useState)(!0),R=Object(l.a)(P,2),U=R[0],z=R[1];return Object(a.useEffect)((function(){D(!1)}),[]),Object(a.useEffect)((function(){D(!(g||k||w||U))}),[w,U,g,k,d,p]),Object(j.jsxs)("div",{className:"auth page__container",children:[Object(j.jsx)("h2",{className:"title title_place_auth",children:t}),Object(j.jsxs)("form",{className:"form",name:"form-edit-".concat(n),onSubmit:function(e){e.preventDefault(),i({email:d,password:p})},noValidate:!0,children:[Object(j.jsxs)("fieldset",{className:"form__fieldset",children:[Object(j.jsxs)("label",{className:"form__label",children:[Object(j.jsx)("input",{type:"email",name:"email",value:d,placeholder:"Email",className:"form__input form__input_type_auth ".concat(g?"form__input_type_error":""),required:!0,minLength:"6",maxLength:"40",onChange:function(e){_(e.target.value),I(!1),x(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(g?"form__input-error_active":""),children:g})]}),Object(j.jsxs)("label",{className:"popup__field",children:[Object(j.jsx)("input",{type:"password",name:"password",value:p,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"form__input form__input_type_auth ".concat(k?"form__input_type_error":""),required:!0,minLength:"6",maxLength:"40",onChange:function(e){O(e.target.value),z(!1),C(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(k?"form__input-error_active":""),children:k})]})]}),Object(j.jsx)("button",{type:"submit",className:"form__button-submit form__button-submit_type_auth ".concat(T?"":"form__button-submit_inactive"),disabled:!T,children:c}),o&&Object(j.jsxs)("div",{className:"form__auth-container",children:[Object(j.jsx)("p",{className:"form__auth-text",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0"}),Object(j.jsx)(s.b,{className:"form__auth-link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})},m=c.a.memo((function(e){return e.isLoading&&Object(j.jsx)("div",{className:"loader",children:Object(j.jsx)("div",{className:"loader__item"})})}));var h=function(e){var t=e.onLogin,n=e.isLoading;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(m,{isLoading:n}),!n&&Object(j.jsx)(_,{title:"\u0412\u0445\u043e\u0434",name:"login",buttonSubmitText:"\u0412\u043e\u0439\u0442\u0438",onSubmit:t})]})};var p=function(e){var t=e.onRegister;return Object(j.jsx)(_,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",name:"register",buttonSubmitText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",onSubmit:t})},O=c.a.createContext();var f=function(e){var t=e.card,n=e.onClickCard,a=e.onCardLike,i=e.onCardDelete,o=c.a.useContext(O),s=t.owner._id===o._id,r=t.likes.some((function(e){return e._id===o._id})),l="elements__button-remove ".concat(s?"elements__button-remove_visible":"elements__button-remove_hidden"),u=r?"elements__button-like elements__button-like_active":"elements__button-like";return Object(j.jsxs)("div",{className:"elements__item",children:[Object(j.jsx)("img",{className:"elements__image",src:"".concat(t.link),alt:"".concat(t.name),onClick:function(){n(t)}}),Object(j.jsx)("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:l,onClick:function(){i(t)}}),Object(j.jsxs)("div",{className:"elements__description",children:[Object(j.jsx)("h2",{className:"elements__name",children:t.name}),Object(j.jsxs)("div",{className:"elements__like-container",children:[Object(j.jsx)("button",{type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",className:u,onClick:function(){a(t)}}),Object(j.jsx)("div",{className:"elements__like-counter",children:t.likes.length})]})]})]})};var v=function(e){var t=e.cards,n=e.editAvatar,a=e.editProfile,i=e.addPlace,o=e.onClickCard,s=e.onCardLike,r=e.onCardDelete,l=c.a.useContext(O);return Object(j.jsxs)("main",{children:[Object(j.jsxs)("section",{className:"profile page__container",children:[Object(j.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(l.avatar,")")},onClick:n}),Object(j.jsxs)("div",{className:"profile__info",children:[Object(j.jsxs)("div",{className:"profile__description",children:[Object(j.jsx)("h1",{className:"profile__name",children:l.name}),Object(j.jsx)("button",{type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",className:"profile__button-edit",onClick:a})]}),Object(j.jsx)("p",{className:"profile__about",children:l.about})]}),Object(j.jsx)("button",{type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",className:"profile__button-add-image",onClick:i,children:" "})]}),Object(j.jsx)("section",{className:"elements",children:t.map((function(e){return Object(j.jsx)(f,{card:e,onClickCard:o,onCardLike:s,onCardDelete:r},e._id)}))})]})},g=Object(a.memo)((function(e){return e.isLoggedIn&&Object(j.jsx)("footer",{className:"footer page__container",children:Object(j.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Mesto Russia"})})}));var x=function(e){var t=e.title,n=e.name,a=e.buttonSubmitText,c=e.children,i=e.isOpen,o=e.onClose,s=e.onSubmit,r=e.isFormValid,l=e.loadingButtonSubmitText,u=e.isLoadingData;return Object(j.jsx)("div",{className:"popup ".concat(i?"popup_opened":""),children:Object(j.jsxs)("div",{className:"popup__container popup__container_form",children:[Object(j.jsx)("h2",{className:"title",children:t}),Object(j.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"button-close",onClick:o}),Object(j.jsxs)("form",{className:"form",name:n,onSubmit:s,noValidate:!0,children:[c,Object(j.jsx)("button",{type:"submit",className:"form__button-submit ".concat(r?"":"form__button-submit_inactive"),disabled:!r,children:u?l:a})]})]})})};var S=function(e){var t=e.isOpen,n=e.onClose,i=e.onUpdateUser,o=e.isLoadingData,s=c.a.useContext(O),r=Object(a.useState)("Name"),u=Object(l.a)(r,2),b=u[0],d=u[1],_=Object(a.useState)("About"),m=Object(l.a)(_,2),h=m[0],p=m[1],f=Object(a.useState)(!0),v=Object(l.a)(f,2),g=v[0],S=v[1],N=Object(a.useState)(!0),k=Object(l.a)(N,2),C=k[0],y=k[1],L=Object(a.useState)(""),T=Object(l.a)(L,2),D=T[0],E=T[1],A=Object(a.useState)(""),w=Object(l.a)(A,2),I=w[0],P=w[1],R=Object(a.useState)(!1),U=Object(l.a)(R,2),z=U[0],M=U[1];return Object(a.useEffect)((function(){s.name&&s.about&&(d(s.name),p(s.about)),S(!0),y(!0)}),[s,t]),Object(a.useEffect)((function(){M(!(!g||!C))}),[g,C]),Object(j.jsx)(x,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"user",buttonSubmitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loadingButtonSubmitText:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),i({name:b,about:h})},isLoadingData:o,isFormValid:z,children:Object(j.jsxs)("fieldset",{className:"form__fieldset",children:[Object(j.jsxs)("label",{className:"form__label",children:[Object(j.jsx)("input",{type:"text",name:"name",placeholder:"\u0418\u043c\u044f",className:"form__input ".concat(g?"":"form__input_type_error"),required:!0,minLength:"2",maxLength:"40",value:b,onChange:function(e){d(e.target.value),S(e.target.validity.valid),E(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(g?"":"form__input-error_active"),children:D})]}),Object(j.jsxs)("label",{className:"form__label",children:[Object(j.jsx)("input",{type:"text",name:"about",placeholder:"\u0427\u0442\u043e-\u0442\u043e \u043e \u0441\u0435\u0431\u0435",className:"form__input ".concat(C?"":"form__input_type_error"),required:!0,minLength:"2",maxLength:"200",value:h,onChange:function(e){p(e.target.value),y(e.target.validity.valid),P(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(C?"":"form__input-error_active"),children:I})]})]})})};var N=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,i=e.isLoadingData,o=Object(a.useState)(""),s=Object(l.a)(o,2),r=s[0],u=s[1],b=Object(a.useState)(!1),d=Object(l.a)(b,2),_=d[0],m=d[1],h=Object(a.useState)(""),p=Object(l.a)(h,2),O=p[0],f=p[1];return Object(a.useEffect)((function(){m(!1),u("")}),[t]),Object(a.useEffect)((function(){m(!O)}),[O,r]),Object(j.jsx)(x,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",buttonSubmitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loadingButtonSubmitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({avatar:r})},isLoadingData:i,isFormValid:_,children:Object(j.jsx)("fieldset",{className:"form__fieldset",children:Object(j.jsxs)("label",{className:"form__label",children:[Object(j.jsx)("input",{type:"url",name:"link","aria-label":"C\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",placeholder:"C\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",className:"form__input ".concat(O?"form__input_type_error":""),required:!0,value:r,onChange:function(e){u(e.target.value),f(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(O?"form__input-error_active":""),children:O})]})})})};var k=function(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,i=e.isLoadingData,o=Object(a.useState)(""),s=Object(l.a)(o,2),r=s[0],u=s[1],b=Object(a.useState)(""),d=Object(l.a)(b,2),_=d[0],m=d[1],h=Object(a.useState)(""),p=Object(l.a)(h,2),O=p[0],f=p[1],v=Object(a.useState)(""),g=Object(l.a)(v,2),S=g[0],N=g[1],k=Object(a.useState)(!1),C=Object(l.a)(k,2),y=C[0],L=C[1],T=Object(a.useState)(!0),D=Object(l.a)(T,2),E=D[0],A=D[1],w=Object(a.useState)(!0),I=Object(l.a)(w,2),P=I[0],R=I[1];return Object(a.useEffect)((function(){u(""),m(""),L(!1),A(!0),R(!0)}),[t]),Object(a.useEffect)((function(){L(!(O||S||E||P))}),[E,P,O,S,r,_]),Object(j.jsx)(x,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"place",buttonSubmitText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",loadingButtonSubmitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:r,link:_})},isLoadingData:i,isFormValid:y,children:Object(j.jsxs)("fieldset",{className:"form__fieldset",children:[Object(j.jsxs)("label",{className:"form__label",children:[Object(j.jsx)("input",{type:"text",name:"place",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input ".concat(O?"form__input_type_error":""),required:!0,minLength:"2",maxLength:"30",value:r,onChange:function(e){u(e.target.value),A(!1),f(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(O?"form__input-error_active":""),children:O})]}),Object(j.jsxs)("label",{className:"form__label",children:[Object(j.jsx)("input",{type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input ".concat(S?"form__input_type_error":""),required:!0,value:_,onChange:function(e){m(e.target.value),R(!1),N(e.target.validationMessage)}}),Object(j.jsx)("span",{className:"form__input-error ".concat(S?"form__input-error_active":""),children:S})]})]})})};var C=function(e){var t=e.isOpen,n=e.onClose,a=e.card,c=e.onSubmitDelete,i=e.isLoadingData;return Object(j.jsx)(x,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"remove",buttonSubmitText:"\u0414\u0430",loadingButtonSubmitText:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(a)},isLoadingData:i,isFormValid:"true"})};var y=function(e){var t=e.card,n=e.onClose;return Object(j.jsx)("div",{className:"popup popup_type_image ".concat(t.link?"popup_opened":""),children:Object(j.jsxs)("div",{className:"popup__container",children:[Object(j.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"button-close popup__button-close",onClick:n}),Object(j.jsxs)("figure",{className:"popup__figure",children:[Object(j.jsx)("img",{className:"popup__photo",src:"".concat(t.link),alt:"".concat(t.name)}),Object(j.jsx)("div",{className:"popup__caption",children:t.name})]})]})})};var L=function(e){var t=e.isOpen,n=e.isSuccess,a=e.onClose;return Object(j.jsx)("div",{className:"popup ".concat(t?"popup_opened":""),children:Object(j.jsxs)("div",{className:"popup__container popup__container_form",children:[Object(j.jsx)("div",{className:"popup__tooltip-image ".concat(n?"":"popup__tooltip-image_type_fail")}),Object(j.jsx)("h2",{className:"title title_place_auth",children:n?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."}),Object(j.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"button-close button-close_place_tooltip",onClick:a})]})})},T=n(23),D=n(24);var E=function(e){var t=e.component,n=Object(D.a)(e,["component"]);return Object(j.jsx)(u.b,{children:function(){return n.isLoggedIn?Object(j.jsx)(t,Object(T.a)({},n)):Object(j.jsx)(u.a,{to:"/sign-in"})}})},A=n(13),w=n(14),I={urlServerAuth:"https://auth.nomoreparties.co",urlServer:"https://mesto.nomoreparties.co/v1",idCohort:"cohort-22",token:"9c2455fb-83bc-4950-8d50-36e17c0acd69"},P=new(function(){function e(t){var n=t.idCohort,a=t.token,c=t.urlServer;Object(A.a)(this,e),this._idCohort=n,this._token=a,this._urlServer=c}return Object(w.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getInitialData",value:function(){return Promise.all([this.getUserInfo(),this.getCards()])}},{key:"getUserInfo",value:function(){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/users/me"),{headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"getCards",value:function(){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/cards"),{headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._checkResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}},{key:"changeLike",value:function(e,t){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/cards/likes/").concat(e._id),{method:t?"PUT":"DELETE",headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"getCountsOfLikes",value:function(e){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/cards/likes/").concat(e._id),{headers:{authorization:this._token}}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._urlServer,"/").concat(this._idCohort,"/cards/").concat(e._id),{method:"DELETE",headers:{authorization:this._token}}).then(this._checkResponse)}}]),e}())(I),R=new(function(){function e(t){var n=t.urlServerAuth;Object(A.a)(this,e),this._urlServerAuth=n}return Object(w.a)(e,[{key:"_handleOriginalResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"checkToken",value:function(e){return fetch("".concat(this._urlServerAuth,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._handleOriginalResponse)}},{key:"register",value:function(e){var t=e.email,n=e.password;return fetch("".concat(this._urlServerAuth,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n,email:t})}).then(this._handleOriginalResponse)}},{key:"login",value:function(e){var t=e.email,n=e.password;return fetch("".concat(this._urlServerAuth,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n,email:t})}).then(this._handleOriginalResponse)}}]),e}())(I);var U=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),o=Object(l.a)(i,2),s=o[0],b=o[1],_=Object(a.useState)(!1),m=Object(l.a)(_,2),f=m[0],x=m[1],T=Object(a.useState)(!1),D=Object(l.a)(T,2),A=D[0],w=D[1],I=Object(a.useState)(!1),U=Object(l.a)(I,2),z=U[0],M=U[1],q=Object(a.useState)(!1),B=Object(l.a)(q,2),F=B[0],J=B[1],V=Object(a.useState)({}),H=Object(l.a)(V,2),G=H[0],K=H[1],Q=Object(a.useState)({}),W=Object(l.a)(Q,2),X=W[0],Y=W[1],Z=Object(a.useState)(""),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)(""),ae=Object(l.a)(ne,2),ce=ae[0],ie=ae[1],oe=Object(a.useState)([]),se=Object(l.a)(oe,2),re=se[0],le=se[1],ue=Object(a.useState)({}),be=Object(l.a)(ue,2),je=be[0],de=be[1],_e=Object(a.useState)(!1),me=Object(l.a)(_e,2),he=me[0],pe=me[1],Oe=Object(a.useState)(!1),fe=Object(l.a)(Oe,2),ve=fe[0],ge=fe[1],xe=Object(a.useState)(!1),Se=Object(l.a)(xe,2),Ne=Se[0],ke=Se[1],Ce=Object(a.useState)(!1),ye=Object(l.a)(Ce,2),Le=ye[0],Te=ye[1],De=Object(a.useState)(!1),Ee=Object(l.a)(De,2),Ae=Ee[0],we=Ee[1],Ie=Object(a.useState)(!1),Pe=Object(l.a)(Ie,2),Re=Pe[0],Ue=Pe[1],ze=Object(u.g)();function Me(){c(!1),b(!1),x(!1),w(!1),M(!1),K({}),de({})}function qe(){ge(!0);var e=localStorage.getItem("jwt");e?R.checkToken(e).then((function(e){te(e.data.email),pe(!0),ge(!1),ze.push("/")})).catch((function(){J(!1),M(!0)})):ge(!1)}function Be(e){R.login(e).then((function(e){localStorage.setItem("jwt",e.token),qe()})).catch((function(){J(!1),M(!0)}))}return Object(a.useEffect)((function(){qe(),J(!1)}),[]),Object(a.useEffect)((function(){P.getInitialData().then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];Y(n),le(a)})).catch((function(e){console.log(e)}))}),[]),Object(j.jsx)("div",{className:"page",children:Object(j.jsxs)(O.Provider,{value:X,children:[Object(j.jsx)(d,{isLoggedIn:he,userEmail:ee,onSignOut:function(){pe(!1),localStorage.removeItem("jwt"),ze.push("/sign-in"),te(""),ie(""),J(null)},isLoading:ve}),Object(j.jsxs)(u.d,{children:[Object(j.jsx)(E,{exact:!0,path:"/",component:v,isLoggedIn:he,editProfile:function(){c(!0)},addPlace:function(){b(!0)},editAvatar:function(){x(!0)},onClickCard:function(e){K(e)},cards:re,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===X._id}));P.changeLike(e,!t).then((function(t){le((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){de(e),w(!0)}}),Object(j.jsx)(u.b,{path:"/sign-up",children:Object(j.jsx)(p,{onRegister:function(e){R.register(e).then((function(t){te(t.data.email),ie(e.password),J(!0),M(!0)})).catch((function(){J(!1),M(!0)}))}})}),Object(j.jsx)(u.b,{path:"/sign-in",children:Object(j.jsx)(h,{onLogin:Be,isLoading:ve})}),Object(j.jsx)(u.b,{children:Object(j.jsx)(u.a,{to:he?"/":"/sign-in"})})]}),Object(j.jsx)(g,{isLoggedIn:he}),Object(j.jsx)(S,{isOpen:n,onClose:Me,onUpdateUser:function(e){ke(!0),P.setUserInfo(e).then((function(e){Y(e),Me()})).catch((function(e){console.log(e)})).finally((function(){ke(!1)}))},currentUser:X,isLoadingData:Ne}),Object(j.jsx)(k,{isOpen:s,onClose:Me,onAddPlace:function(e){we(!0),P.postCard(e).then((function(e){le([e].concat(Object(r.a)(re))),Me()})).catch((function(e){console.log(e)})).finally((function(){we(!1)}))},isLoadingData:Ae}),Object(j.jsx)(N,{isOpen:f,onClose:Me,onUpdateAvatar:function(e){var t=e.avatar;Te(!0),P.setUserAvatar(t).then((function(e){Y(e),Me()})).catch((function(e){console.log(e)})).finally((function(){Te(!1)}))},isLoadingData:Le}),Object(j.jsx)(C,{isOpen:A,onClose:Me,card:je,onSubmitDelete:function(e){Ue(!0),P.deleteCard(e).then((function(){le(re.filter((function(t){return t._id!==e._id}))),Me()})).catch((function(e){console.log(e)})).finally((function(){Ue(!1)}))},isLoadingData:Re}),Object(j.jsx)(y,{card:G,onClose:Me}),Object(j.jsx)(L,{isOpen:z,onClose:function(){Me(),F&&Be({email:ee,password:ce})},isSuccess:F,isToolTipForm:!0})]})})};o.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(s.a,{children:Object(j.jsx)(U,{})})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.a8df9abf.chunk.js.map